<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Selector de Color Vibrante</title>
  
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  
  <style>
    :root {
      --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      --shadow: 0 10px 30px rgba(0,0,0,0.15);
      --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
    }

    body {
      background: linear-gradient(135deg, #f0f4ff 0%, #e0eaff 100%);
      min-height: 100vh;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, sans-serif;
    }

    .card-modern {
      border: none;
      border-radius: 24px;
      overflow: hidden;
      box-shadow: var(--shadow);
      background: rgba(255, 255, 255, 0.75);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      transition: var(--transition);
    }

    .card-header {
      background: var(--primary-gradient);
      border-radius: 24px 24px 0 0;
      padding: 1.5rem;
    }

    .color-box {
      height: 220px;
      border-radius: 16px;
      border: none;
      box-shadow: inset 0 4px 15px rgba(0,0,0,0.12);
      transition: background-color 0.4s ease, transform 0.3s ease;
      margin-bottom: 1.5rem;
    }

    .color-box:hover {
      transform: scale(1.015);
    }

    .form-label {
      font-weight: 600;
      font-size: 1.1rem;
      margin-bottom: 0.5rem;
      transition: var(--transition);
    }

    .text-danger    { color: #ff4d4d !important; }
    .text-success   { color: #00d084 !important; }
    .text-primary   { color: #5e60ce !important; }

    .form-range {
      height: 10px;
      padding: 0;
    }

    .form-range::-webkit-slider-thumb {
      background: linear-gradient(90deg, currentColor, #a5b4fc);
      border: 4px solid white;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }

    .form-range::-moz-range-thumb {
      background: linear-gradient(90deg, currentColor, #a5b4fc);
      border: 4px solid white;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }

    .input-group .form-control {
      border-radius: 12px !important;
      font-weight: 500;
    }

    .btn-copy {
      border-radius: 12px;
      font-weight: 600;
      transition: var(--transition);
    }

    .btn-copy:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(94, 96, 206, 0.3);
    }

    .number-box {
      border-radius: 12px;
      font-weight: 600;
      text-align: center;
    }

    .hex-input {
      font-family: 'Courier New', Courier, monospace;
      letter-spacing: 1px;
    }
  </style>
</head>
<body class="p-4 p-md-5">

  <div class="container" style="max-width: 540px;">
    <div class="card-modern">

      <div class="card-header text-white text-center">
        <h3 class="mb-0 fw-bold">Selector de Color</h3>
        <small class="opacity-75">Elige, mezcla, copia</small>
      </div>

      <div class="card-body p-4 p-md-5">

        <div id="colorBox" class="color-box shadow-lg"></div>

        <div class="text-center mb-4">
          <h5 class="fw-bold mb-1">RGB: <span id="rgbText">rgb(128, 128, 128)</span></h5>
          <div class="d-flex align-items-center justify-content-center gap-2">
            <h5 class="fw-bold mb-0">HEX: <span id="hexText">#808080</span></h5>
            <button class="btn btn-sm btn-outline-secondary btn-copy" id="copyBtn" title="Copiar HEX">
              Copiar
            </button>
          </div>
        </div>

        <!-- HEX Input -->
        <div class="mb-4">
          <label for="hexInput" class="form-label">Código HEX</label>
          <div class="input-group input-group-lg">
            <span class="input-group-text">#</span>
            <input type="text" class="form-control hex-input text-uppercase" 
                   id="hexInput" maxlength="6" value="808080">
          </div>
        </div>

        <!-- Rojo -->
        <div class="mb-4">
          <label for="rangeR" class="form-label text-danger">Rojo</label>
          <div class="d-flex align-items-center gap-3">
            <input type="range" class="form-range flex-grow-1" id="rangeR" min="0" max="255" value="128">
            <input type="number" class="form-control number-box" id="inputR" min="0" max="255" value="128">
          </div>
        </div>

        <!-- Verde -->
        <div class="mb-4">
          <label for="rangeG" class="form-label text-success">Verde</label>
          <div class="d-flex align-items-center gap-3">
            <input type="range" class="form-range flex-grow-1" id="rangeG" min="0" max="255" value="128">
            <input type="number" class="form-control number-box" id="inputG" min="0" max="255" value="128">
          </div>
        </div>

        <!-- Azul -->
        <div class="mb-4">
          <label for="rangeB" class="form-label text-primary">Azul</label>
          <div class="d-flex align-items-center gap-3">
            <input type="range" class="form-range flex-grow-1" id="rangeB" min="0" max="255" value="128">
            <input type="number" class="form-control number-box" id="inputB" min="0" max="255" value="128">
          </div>
        </div>

      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    const colorBox = document.getElementById('colorBox');
    const rgbText  = document.getElementById('rgbText');
    const hexText  = document.getElementById('hexText');
    const hexInput = document.getElementById('hexInput');
    const copyBtn  = document.getElementById('copyBtn');

    const rangeR = document.getElementById('rangeR');
    const rangeG = document.getElementById('rangeG');
    const rangeB = document.getElementById('rangeB');

    const inputR = document.getElementById('inputR');
    const inputG = document.getElementById('inputG');
    const inputB = document.getElementById('inputB');

    function hexToRgb(hex) {
      hex = hex.replace('#', '').trim().toUpperCase();
      if (hex.length === 3) hex = hex.split('').map(c => c + c).join('');
      if (hex.length !== 6 || !/^[0-9A-F]{6}$/.test(hex)) return null;
      return {
        r: parseInt(hex.substr(0,2), 16),
        g: parseInt(hex.substr(2,2), 16),
        b: parseInt(hex.substr(4,2), 16)
      };
    }

    function updateFromHex() {
      const rgb = hexToRgb(hexInput.value);
      if (rgb) {
        rangeR.value = inputR.value = rgb.r;
        rangeG.value = inputG.value = rgb.g;
        rangeB.value = inputB.value = rgb.b;
        updateColor();
      } else {
        hexInput.classList.add('is-invalid');
        setTimeout(() => hexInput.classList.remove('is-invalid'), 1200);
      }
    }

    function updateColor() {
      let r = Math.max(0, Math.min(255, parseInt(rangeR.value) || 0));
      let g = Math.max(0, Math.min(255, parseInt(rangeG.value) || 0));
      let b = Math.max(0, Math.min(255, parseInt(rangeB.value) || 0));

      rangeR.value = inputR.value = r;
      rangeG.value = inputG.value = g;
      rangeB.value = inputB.value = b;

      const rgbString = `rgb(${r}, ${g}, ${b})`;
      const hexString = '#' + [r,g,b].map(x => x.toString(16).padStart(2,'0')).join('');

      colorBox.style.backgroundColor = rgbString;
      rgbText.textContent = rgbString;
      hexText.textContent = hexString.toUpperCase();

      // Actualizar input HEX sin loop infinito
      const cleanHex = hexString.substring(1).toUpperCase();
      if (hexInput.value.toUpperCase() !== cleanHex) {
        hexInput.value = cleanHex;
      }

      // Fondo body dinámico (vibrante)
      document.body.style.background = 
        `linear-gradient(135deg, ${rgbString}22 0%, #f0f4ff 100%)`;

      hexInput.classList.remove('is-invalid');
    }

    // Eventos
    rangeR.addEventListener('input', updateColor);
    rangeG.addEventListener('input', updateColor);
    rangeB.addEventListener('input', updateColor);

    inputR.addEventListener('input', () => { rangeR.value = inputR.value; updateColor(); });
    inputG.addEventListener('input', () => { rangeG.value = inputG.value; updateColor(); });
    inputB.addEventListener('input', () => { rangeB.value = inputB.value; updateColor(); });

    hexInput.addEventListener('input', updateFromHex);
    hexInput.addEventListener('blur', updateFromHex);

    // Copiar HEX
    copyBtn.addEventListener('click', () => {
      navigator.clipboard.writeText(hexText.textContent).then(() => {
        copyBtn.textContent = '¡Copiado!';
        copyBtn.classList.add('btn-success');
        setTimeout(() => {
          copyBtn.textContent = 'Copiar';
          copyBtn.classList.remove('btn-success');
        }, 1800);
      });
    });

    // Inicio
    updateColor();
  </script>

</body>
</html>